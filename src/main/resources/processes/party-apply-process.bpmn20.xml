<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:flowable="http://flowable.org/bpmn"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
             typeLanguage="http://www.w3.org/2001/XMLSchema"
             expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.flowable.org/processdef">
    
    <process id="partyApplyProcess" name="党章申请流程" isExecutable="true">
        
        <startEvent id="startEvent" name="开始"/>
        
        <sequenceFlow id="flow1" sourceRef="startEvent" targetRef="headTeacherApproval"/>
        
        <userTask id="headTeacherApproval" name="班主任审批" flowable:candidateGroups="CLASSGUIDE">
            <extensionElements>
                <flowable:taskListener event="complete" delegateExpression="${approvalTaskListener}"/>
            </extensionElements>
        </userTask>
        
        <sequenceFlow id="flow2" sourceRef="headTeacherApproval" targetRef="gateway1"/>
        
        <exclusiveGateway id="gateway1" name="班主任审批结果"/>
        
        <sequenceFlow id="flow3" name="同意" sourceRef="gateway1" targetRef="counselorApproval">
            <conditionExpression xsi:type="tFormalExpression">${approved == true}</conditionExpression>
        </sequenceFlow>
        
        <sequenceFlow id="flow4" name="拒绝" sourceRef="gateway1" targetRef="rejectEndEvent">
            <conditionExpression xsi:type="tFormalExpression">${approved == false}</conditionExpression>
        </sequenceFlow>
        
        <userTask id="counselorApproval" name="辅导员审批" flowable:candidateGroups="MENTOR">
            <extensionElements>
                <flowable:taskListener event="complete" delegateExpression="${approvalTaskListener}"/>
            </extensionElements>
        </userTask>
        
        <sequenceFlow id="flow5" sourceRef="counselorApproval" targetRef="gateway2"/>
        
        <exclusiveGateway id="gateway2" name="辅导员审批结果"/>
        
        <sequenceFlow id="flow6" name="同意" sourceRef="gateway2" targetRef="deanApproval">
            <conditionExpression xsi:type="tFormalExpression">${approved == true}</conditionExpression>
        </sequenceFlow>
        
        <sequenceFlow id="flow7" name="拒绝" sourceRef="gateway2" targetRef="rejectEndEvent">
            <conditionExpression xsi:type="tFormalExpression">${approved == false}</conditionExpression>
        </sequenceFlow>
        
        <userTask id="deanApproval" name="学院院长审批" flowable:candidateGroups="DEAN">
            <extensionElements>
                <flowable:taskListener event="complete" delegateExpression="${approvalTaskListener}"/>
            </extensionElements>
        </userTask>
        
        <sequenceFlow id="flow8" sourceRef="deanApproval" targetRef="gateway3"/>
        
        <exclusiveGateway id="gateway3" name="学院院长审批结果"/>
        
        <sequenceFlow id="flow9" name="同意" sourceRef="gateway3" targetRef="partySecretaryApproval">
            <conditionExpression xsi:type="tFormalExpression">${approved == true}</conditionExpression>
        </sequenceFlow>
        
        <sequenceFlow id="flow10" name="拒绝" sourceRef="gateway3" targetRef="rejectEndEvent">
            <conditionExpression xsi:type="tFormalExpression">${approved == false}</conditionExpression>
        </sequenceFlow>
        
        <userTask id="partySecretaryApproval" name="党委书记审批" flowable:candidateGroups="PARTYSECRETARY">
            <extensionElements>
                <flowable:taskListener event="complete" delegateExpression="${approvalTaskListener}"/>
            </extensionElements>
        </userTask>
        
        <sequenceFlow id="flow11" sourceRef="partySecretaryApproval" targetRef="gateway4"/>
        
        <exclusiveGateway id="gateway4" name="党委书记审批结果"/>
        
        <sequenceFlow id="flow12" name="同意" sourceRef="gateway4" targetRef="endEvent">
            <conditionExpression xsi:type="tFormalExpression">${approved == true}</conditionExpression>
        </sequenceFlow>
        
        <sequenceFlow id="flow13" name="拒绝" sourceRef="gateway4" targetRef="rejectEndEvent">
            <conditionExpression xsi:type="tFormalExpression">${approved == false}</conditionExpression>
        </sequenceFlow>
        
        <endEvent id="endEvent" name="通过"/>
        
        <endEvent id="rejectEndEvent" name="拒绝"/>
        
    </process>
    
    <bpmndi:BPMNDiagram id="BPMNDiagram_partyApplyProcess">
        <bpmndi:BPMNPlane bpmnElement="partyApplyProcess" id="BPMNPlane_partyApplyProcess">
            <bpmndi:BPMNShape bpmnElement="startEvent" id="BPMNShape_startEvent">
                <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="headTeacherApproval" id="BPMNShape_headTeacherApproval">
                <omgdc:Bounds height="80.0" width="100.0" x="180.0" y="138.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway1" id="BPMNShape_gateway1">
                <omgdc:Bounds height="40.0" width="40.0" x="330.0" y="158.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="counselorApproval" id="BPMNShape_counselorApproval">
                <omgdc:Bounds height="80.0" width="100.0" x="410.0" y="138.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway2" id="BPMNShape_gateway2">
                <omgdc:Bounds height="40.0" width="40.0" x="560.0" y="158.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="deanApproval" id="BPMNShape_deanApproval">
                <omgdc:Bounds height="80.0" width="100.0" x="640.0" y="138.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway3" id="BPMNShape_gateway3">
                <omgdc:Bounds height="40.0" width="40.0" x="790.0" y="158.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="partySecretaryApproval" id="BPMNShape_partySecretaryApproval">
                <omgdc:Bounds height="80.0" width="100.0" x="870.0" y="138.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway4" id="BPMNShape_gateway4">
                <omgdc:Bounds height="40.0" width="40.0" x="1020.0" y="158.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="endEvent" id="BPMNShape_endEvent">
                <omgdc:Bounds height="28.0" width="28.0" x="1100.0" y="164.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="rejectEndEvent" id="BPMNShape_rejectEndEvent">
                <omgdc:Bounds height="28.0" width="28.0" x="796.0" y="300.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
                <omgdi:waypoint x="130.0" y="178.0"/>
                <omgdi:waypoint x="180.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
                <omgdi:waypoint x="280.0" y="178.0"/>
                <omgdi:waypoint x="330.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
                <omgdi:waypoint x="370.0" y="178.0"/>
                <omgdi:waypoint x="410.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
                <omgdi:waypoint x="350.0" y="198.0"/>
                <omgdi:waypoint x="350.0" y="314.0"/>
                <omgdi:waypoint x="796.0" y="314.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
                <omgdi:waypoint x="510.0" y="178.0"/>
                <omgdi:waypoint x="560.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
                <omgdi:waypoint x="600.0" y="178.0"/>
                <omgdi:waypoint x="640.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
                <omgdi:waypoint x="580.0" y="198.0"/>
                <omgdi:waypoint x="580.0" y="314.0"/>
                <omgdi:waypoint x="796.0" y="314.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
                <omgdi:waypoint x="740.0" y="178.0"/>
                <omgdi:waypoint x="790.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
                <omgdi:waypoint x="830.0" y="178.0"/>
                <omgdi:waypoint x="870.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
                <omgdi:waypoint x="810.0" y="198.0"/>
                <omgdi:waypoint x="810.0" y="314.0"/>
                <omgdi:waypoint x="796.0" y="314.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
                <omgdi:waypoint x="970.0" y="178.0"/>
                <omgdi:waypoint x="1020.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
                <omgdi:waypoint x="1060.0" y="178.0"/>
                <omgdi:waypoint x="1100.0" y="178.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
                <omgdi:waypoint x="1040.0" y="198.0"/>
                <omgdi:waypoint x="1040.0" y="314.0"/>
                <omgdi:waypoint x="824.0" y="314.0"/>
            </bpmndi:BPMNEdge>
        </bpmndi:BPMNPlane>
    </bpmndi:BPMNDiagram>
</definitions>
